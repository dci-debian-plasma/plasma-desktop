#!/usr/bin/make -f
# -*- makefile -*-

l10npkgs_firstversion_ok := 4:15.08.3-0ubuntu2~

DEB_HOST_ARCH ?= $(shell dpkg-architecture -qDEB_HOST_ARCH)
ifneq (,$(filter $(DEB_HOST_ARCH), mips mipsel))
    export DEB_CFLAGS_MAINT_STRIP = -g
    export DEB_CXXFLAGS_MAINT_STRIP = -g
    export DEB_CFLAGS_MAINT_APPEND = -gstabs
    export DEB_CXXFLAGS_MAINT_APPEND = -gstabs
endif

include /usr/share/pkg-kde-tools/qt-kde-team/3/debian-qt-kde.mk
include /usr/share/pkg-kde-tools/qt-kde-team/2/l10n-packages.mk

override_dh_strip:
	$(overridden_command) --dbg-package=plasma-desktop-dbg

override_dh_auto_test:
	# Disable dh_auto_test, fourth test never ends
	# xvfb-run -a dh_auto_test
	:

override_dh_auto_install:
	$(overridden_command)
	# conflicting with kde4, kde-l10n (lower and *equal* to 16.04)
	# As discussed on IRC while removing it from plasma-desktop is fairly
	# shitty it is our best option (at the time of writing we do not
	# build kde-l10n yet).
	# https://bugs.kde.org/show_bug.cgi?id=362944
	rm -f debian/tmp/usr/share/locale/*/LC_MESSAGES/kcm_activities.mo
	rm -f debian/plasma-desktop/usr/share/locale/*/LC_MESSAGES/kcm_activities.mo
